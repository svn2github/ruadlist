#!/bin/bash
# update files before commiting changes back
svn update
# re-generate hashes
./hash.pl advblock.txt
./hash.pl antinuha.txt
./hash.pl bitblock.txt
./hash.pl cntblock.txt
# get diffs
echo -------------------------------------------------------------------------------
echo - Diff-list.
echo -------------------------------------------------------------------------------
svn --diff-cmd "diff" -x "-u1" diff
# check for common mistakes and unified style
echo -------------------------------------------------------------------------------
echo - \"Fix-it before commit\" auto-generated block.
echo -------------------------------------------------------------------------------
grep --color=auto '^[^/!].*\^[^$*=]' *.txt
grep --color=auto object_ *.txt
grep --color=auto '^[^!].*domain=.*,' *.txt
# type commit message
echo -------------------------------------------------------------------------------
echo Type commit message, save and close nano. Press Ctrl+C \(here\) to stop commit.
echo -------------------------------------------------------------------------------
xterm -e nano --softwrap svn-commit.msg
if [ $? = 0 ]; then
	# ask for comments in separate window and commit
	svn commit -F svn-commit.msg
	# remove temporary files
	rm -f svn-commit.msg
fi
rm -rf *~
rm -rf *.save

